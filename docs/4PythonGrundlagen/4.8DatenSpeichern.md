# 4.8 Daten speichern

In diesem Kapitel lernen wir, wie wir Daten in Python dauerhaft speichern und verwalten k√∂nnen. Das Speichern von Daten ist ein grundlegender Bestandteil vieler Anwendungen, insbesondere wenn Informationen √ºber l√§ngere Zeitr√§ume hinweg verf√ºgbar sein m√ºssen. Wir werden uns mit verschiedenen Methoden des Speicherns von Daten befassen, angefangen von einfachen Textdateien bis hin zu komplexeren Datenformaten wie JSON.

## üìú √úbersicht Daten speichern

Daten k√∂nnen in verschiedenen Formaten und auf unterschiedliche Arten gespeichert werden. Je nach Anwendungsfall k√∂nnen Sie einfache Textdateien verwenden, um Daten im Klartext zu speichern, oder komplexere Strukturen wie JSON, die sich gut f√ºr das Speichern von strukturierten Daten eignen.

| Methode                | Beschreibung                                                   |
|------------------------|----------------------------------------------------------------|
| Textdateien            | Speichert Daten im Klartext. Geeignet f√ºr einfache, unstrukturierte Daten. |
| CSV-Dateien            | Speichert tabellarische Daten im CSV-Format (Comma-Separated Values). |
| JSON-Dateien           | Speichert strukturierte Daten im JSON-Format (JavaScript Object Notation). |
| Bin√§re Dateien         | Speichert Daten in einem bin√§ren Format, das nicht direkt lesbar ist. |
| Datenbanken (SQLite)   | Verwaltet gro√üe Datenmengen strukturiert und bietet erweiterte Abfragem√∂glichkeiten. |

### Spezifischere Anweisungen und Methoden

Diese Tabelle beschreibt spezifischere Anweisungen und Methoden, die im Zusammenhang mit dem Speichern von Daten in Python verwendet werden.

| Anweisung/Methode      | Beschreibung                                                   |
|------------------------|----------------------------------------------------------------|
| [`open()`](https://docs.python.org/3/library/functions.html#open)               | √ñffnet eine Datei zum Lesen (`"r"`), Schreiben (`"w"`), Anh√§ngen (`"a"`) oder als Bin√§rdatei (`"b"`). |
| [`write()`](https://docs.python.org/3/tutorial/inputoutput.html#methods-of-file-objects)              | Schreibt Daten in eine ge√∂ffnete Datei.                        |
| [`read()`](https://docs.python.org/3/tutorial/inputoutput.html#methods-of-file-objects)               | Liest Daten aus einer ge√∂ffneten Datei.                        |
| [`json.dump()`](https://docs.python.org/3/library/json.html#json.dump)          | Schreibt ein Python-Objekt (z.B. Dictionary) in eine JSON-Datei. |
| [`json.load()`](https://docs.python.org/3/library/json.html#json.load)          | Liest Daten aus einer JSON-Datei und wandelt sie in ein Python-Objekt um. |
| [`csv.writer()`](https://docs.python.org/3/library/csv.html#csv.writer)         | Schreibt Daten in eine CSV-Datei.                               |
| [`csv.reader()`](https://docs.python.org/3/library/csv.html#csv.reader)         | Liest Daten aus einer CSV-Datei.                                |
| [`wb`](https://docs.python.org/3/library/functions.html#open)                   | Modus zum √ñffnen einer Datei zum Schreiben im Bin√§rformat.      |
| [`rb`](https://docs.python.org/3/library/functions.html#open)                   | Modus zum √ñffnen einer Datei zum Lesen im Bin√§rformat.          |
| [`with`](https://docs.python.org/3/reference/compound_stmts.html#with)                 | Sorgt daf√ºr, dass Dateien ordnungsgem√§√ü ge√∂ffnet und geschlossen werden, auch wenn ein Fehler auftritt. |



## üíæ Speichern in Textdateien

Eine der einfachsten Methoden, Daten zu speichern, ist die Verwendung von Textdateien. Textdateien sind besonders n√ºtzlich, wenn Sie einfache Daten speichern m√∂chten, die keinen speziellen Formatierungsbedarf haben.

### Beispiel: Schreiben und Lesen einer Textdatei

```python linenums="1"
# Schreiben und lesen aus einer Textdatei
# J. Thomaschewski, 04.09.2024

# Schreiben in eine Textdatei
with open("daten.txt", "w") as datei:
    datei.write("Dies ist eine gespeicherte Nachricht.\n")

# Lesen aus einer Textdatei
with open("daten.txt", "r") as datei:
    inhalt = datei.read()
    print(inhalt)
```

In diesem Beispiel wird eine Textdatei erstellt und eine einfache Nachricht darin gespeichert. Anschlie√üend wird der Inhalt der Datei gelesen und auf der Konsole ausgegeben.

Schauen Sie nach: auf dem Pi Pico liegt nun eine Datei daten.txt.

## üíæ Speichern in JSON-Dateien

JSON (JavaScript Object Notation) ist ein weit verbreitetes Format zum Speichern und √úbertragen von strukturierten Daten. Es ist ideal f√ºr das Speichern von Daten, die in einem hierarchischen Format vorliegen, wie z.B. Dictionaries oder Listen.

### Beispiel: Speichern und Laden von Daten im JSON-Format

```python linenums="1"
# Schreiben und lesen im JSON-Format
# J. Thomaschewski, 04.09.2024
import json

# Daten als Dictionary
daten = {
    "name": "Ute",
    "alter": 22,
    "stadt": "Emden"
}

# Schreiben der Daten in eine JSON-Datei
with open("daten.json", "w") as jsonDatei:
    json.dump(daten, jsonDatei)

# Lesen der Daten aus einer JSON-Datei
with open("daten.json", "r") as jsonDatei:
    geladeneDaten = json.load(jsonDatei)
    print(geladeneDaten)
```

In diesem Beispiel werden Daten in einer JSON-Datei gespeichert und anschlie√üend wieder aus der Datei gelesen. JSON ist besonders n√ºtzlich, wenn Sie komplexere Datenstrukturen wie Dictionaries speichern m√∂chten.

## üíæ Speichern in CSV-Dateien (nicht in Micro-Python!)

CSV-Dateien (Comma-Separated Values) sind n√ºtzlich, um tabellarische Daten zu speichern. Jede Zeile einer CSV-Datei stellt eine Datenzeile dar, und die einzelnen Werte sind durch Kommas getrennt.

Folgendes Beispiel k√∂nnen wir in MicroPython nicht probieren, da es keine Bibliothek `csv` gibt. Hier k√∂nnten wir eine "richtige" Python-Umgebung mit dem Editor *"Visual Studio Code"* verwenden.

### Beispiel: Speichern und Lesen von Daten im CSV-Format

```python linenums="1"
# Schreiben und lesen - csv
# J. Thomaschewski, 04.09.2024
import csv

# Daten als Liste von Listen
daten = [
    ["Name", "Alter", "Stadt"],
    ["Micha", 25, "Emden"],
    ["Anna", 23, "Berlin"]
]

# Schreiben der Daten in eine CSV-Datei
with open("daten.csv", "w", newline="") as csvDatei:
    writer = csv.writer(csvDatei)
    writer.writerows(daten)

# Lesen der Daten aus einer CSV-Datei
with open("daten.csv", "r") as csvDatei:
    reader = csv.reader(csvDatei)
    for zeile in reader:
        print(zeile)
```

In diesem Beispiel werden tabellarische Daten in einer CSV-Datei gespeichert und anschlie√üend wieder aus der Datei gelesen.

## üîå Pi Pico Script: Speichern von Sensordaten

In diesem Beispiel speichern wir Sensordaten, die vom BMP280-Sensor auf dem Pi Pico erfasst werden, in einer Textdatei.

```python linenums="1"
# Sensordaten speichern (BMP280)
# J. Thomaschewski, 04.09.2024
from machine import Pin, SoftI2C
from bmp280 import BMP280
from time import sleep

# Initialize I2C communication (GPIO angepasst)
i2c = SoftI2C(scl=Pin(17), sda=Pin(16), freq=400000)
bmp = BMP280(i2c)

with open("bmp280Sensordaten.txt", "w") as datei:
    for _ in range(10):
        # Messwerte erfassen
        temperature = bmp.temperature
        pressure = bmp.pressure / 100  # hPa

        # Speichern der Sensordaten in der Textdatei
        datei.write(f"Temperatur: {temperature:.2f}¬∞C, Luftdruck: {pressure:.2f} hPa\n")
        sleep(2)

print("Sensordaten wurden gespeichert.")
```

In diesem Beispiel werden die Temperatur- und Luftdruckwerte zehnmal erfasst und in einer Textdatei gespeichert. Jede Zeile der Datei enth√§lt die Messwerte f√ºr Temperatur und Luftdruck.

!!! question "Aufgabe"

    Schreiben Sie ein Script, das die Sensordaten des BMP280-Sensors in einer JSON-Datei speichert und anschlie√üend wieder ausliest. Speichern Sie mindestens drei verschiedene Messungen in der Datei.

    ??? example "L√∂sung"

        ```python linenums="1"
        # Loesung der Aufgabe BMP280-Sensors - JSON
        # J. Thomaschewski, 04.09.2024
        import json
        from machine import Pin, SoftI2C
        from bmp280 import BMP280
        from time import sleep

        # Initialize I2C communication
        i2c = SoftI2C(scl=Pin(17), sda=Pin(16), freq=400000)
        bmp = BMP280(i2c)
        daten = []

        # Erfassen von Sensordaten
        for _ in range(3):
            temperature = bmp.temperature
            pressure = bmp.pressure / 100  # hPa
            daten.append({"Temperatur": temperature, "Luftdruck": pressure})
            sleep(2)

        # Speichern der Daten in einer JSON-Datei
        with open("bmp280Sensordaten.json", "w") as jsonDatei:
            json.dump(daten, jsonDatei)

        # Lesen der Daten aus der JSON-Datei
        with open("bmp280Sensordaten.json", "r") as jsonDatei:
            geladeneDaten = json.load(jsonDatei)
            print(f"Geladene Sensordaten: {geladeneDaten}")
        ```



## üé¨ Einfache Programmier-Videos
Wer gut programmieren kann, kann es auch ohne das Video schaffen!
Hier die Spielregeln: [https://www.gruppenspiele-hits.de/wenig-material-spiele/Die-verflixte-Eins.html](https://www.gruppenspiele-hits.de/wenig-material-spiele/Die-verflixte-Eins.html)

Besonderheit: man soll mindestens 51 Punkte insgesamt haben.


[https://www.youtube.com/watch?v=21FnnGKSRZo](https://www.youtube.com/watch?v=21FnnGKSRZo) Start bei 2:15 und Ende bei 23:45.


Wenn das Spiel programmiert wurde, dann sind hier folgende Erweiterungen m√∂glich: 

- Anleitung auf deutsch schreiben

- F√ºr 1 ‚Äì 3 Spieler:innen erstellen

- Mit zwei W√ºrfeln w√ºrfeln und bei ‚Äû2‚Äú oder ‚Äû3‚Äú verliert man die Punkte
